<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Working with custom chains | Alan.dart</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/alan.dart/assets/logo.png">
    <link rel="apple-touch-icon" sizes="57x57" href="/alan.dart/assets/pwa/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/alan.dart/assets/pwa/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/alan.dart/assets/pwa/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/alan.dart/assets/pwa/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/alan.dart/assets/pwa/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/alan.dart/assets/pwa/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/alan.dart/assets/pwa/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/alan.dart/assets/pwa/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/alan.dart/assets/pwa/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/alan.dart/assets/pwa/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/alan.dart/assets/pwa/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/alan.dart/assets/pwa/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/alan.dart/assets/pwa/favicon-16x16.png">
    <link rel="manifest" href="/alan.dart/assets/pwa/manifest.json">
    <meta name="description" content="Documentation for the Alan.dart SDK">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta property="og:title" content="Alan.dart documentation">
    <meta property="og:description" content="Learn how to use the Alan.dart SDK">
    <meta roperty="og:type" content="website">
    <meta property="og:locale" content="en_US">
    
    <link rel="preload" href="/alan.dart/assets/css/0.styles.4a76bf78.css" as="style"><link rel="preload" href="/alan.dart/assets/js/app.11920c19.js" as="script"><link rel="preload" href="/alan.dart/assets/js/2.d636a34c.js" as="script"><link rel="preload" href="/alan.dart/assets/js/8.bd141b9f.js" as="script"><link rel="prefetch" href="/alan.dart/assets/js/10.a658c3e3.js"><link rel="prefetch" href="/alan.dart/assets/js/11.8ae3fa13.js"><link rel="prefetch" href="/alan.dart/assets/js/12.926267cf.js"><link rel="prefetch" href="/alan.dart/assets/js/13.be637db4.js"><link rel="prefetch" href="/alan.dart/assets/js/3.c9257ea3.js"><link rel="prefetch" href="/alan.dart/assets/js/4.030ce163.js"><link rel="prefetch" href="/alan.dart/assets/js/5.983396c3.js"><link rel="prefetch" href="/alan.dart/assets/js/6.ad245f27.js"><link rel="prefetch" href="/alan.dart/assets/js/7.40b1c636.js"><link rel="prefetch" href="/alan.dart/assets/js/9.a0002499.js">
    <link rel="stylesheet" href="/alan.dart/assets/css/0.styles.4a76bf78.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/alan.dart/" class="home-link router-link-active"><img src="/alan.dart/assets/logo.png" alt="Alan.dart" class="logo"> <span class="site-name can-hide">Alan.dart</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/alan-sdk/alan.dart" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/alan-sdk/alan.dart" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/alan.dart/wallet/overview.html" class="sidebar-link">Creating a wallet</a></li><li><a href="/alan.dart/transactions/overview.html" class="sidebar-link">Performing a transaction</a></li><li><a href="/alan.dart/queries/overview.html" class="sidebar-link">Querying the chain</a></li><li><a href="/alan.dart/modules/overview.html" class="sidebar-link">Supported Cosmos modules</a></li><li><a href="/alan.dart/custom-chains/overview.html" aria-current="page" class="active sidebar-link">Working with custom chains</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/alan.dart/custom-chains/overview.html#generating-custom-protobuf-implementations" class="sidebar-link">Generating custom Protobuf implementations</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/alan.dart/custom-chains/overview.html#_1-get-the-proto-files" class="sidebar-link">1. Get the .proto files</a></li><li class="sidebar-sub-header"><a href="/alan.dart/custom-chains/overview.html#_2-generate-the-dart-files" class="sidebar-link">2. Generate the .dart files.</a></li></ul></li><li class="sidebar-sub-header"><a href="/alan.dart/custom-chains/overview.html#build-errors" class="sidebar-link">Build errors</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="working-with-custom-chains"><a href="#working-with-custom-chains" class="header-anchor">#</a> Working with custom chains</h1> <p>Given Alan.dart now works primarily based on Protobuf, in order to use it with a custom chain you will need to generate the proper files. This will make sure you are able to create transactions containing custom messages or to query the chain for custom modules. Following, you can find how to do this.</p> <h2 id="generating-custom-protobuf-implementations"><a href="#generating-custom-protobuf-implementations" class="header-anchor">#</a> Generating custom Protobuf implementations</h2> <h3 id="_1-get-the-proto-files"><a href="#_1-get-the-proto-files" class="header-anchor">#</a> 1. Get the <code>.proto</code> files</h3> <p>The first thing you have to do is to get the <code>.proto</code> files necessary to compile everything. Most custom chains include those files into two separate folders: <code>proto</code> and <code>third_party</code>:</p> <ul><li><p>inside the <code>proto</code> folder you can usually find the various <code>.proto</code> files that are used to generate custom messages, queriers, etc;</p></li> <li><p>inside the <code>third_party</code>, instead, you can find all the other <code>.proto</code> files that are taken from third party projects (such as Protobuf, Google, Cosmos, etc) and are still required to compile the custom ones.</p></li></ul> <p>That being said, what you want to do is get those two folders (<code>proto</code> and <code>third_party</code>) and put them into your project root folder. As an example, this is the folder structure of Alan.dart's root folder:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Alan.dart
├── proto
│    └── cosmos
│         ├── auth
│         ├── bank
│         ├── base
│         ├── capability
│         ├── crisis
│         ├── crypto
│         ├── distribution
│         ├── evidence
│         ├── genutil
│         ├── gov
│         ├── mint
│         ├── params
│         ├── slashing
│         ├── staking
│         ├── tx
│         ├── upgrade
│         └── vesting
│
├── third_party
│    └── proto
│         ├── confio
│         ├── cosmos_proto
│         ├── gogoproto
│         ├── google
│         └── tendermint
├── ...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>As you can see, the <code>proto</code> folder contains all the Cosmos-related <code>.proto</code> files, while the <code>third_party</code> contains all the <code>.proto</code> files needed in other to compile the Cosmos ones properly.</p> <h3 id="_2-generate-the-dart-files"><a href="#_2-generate-the-dart-files" class="header-anchor">#</a> 2. Generate the <code>.dart</code> files.</h3> <p>Now that you have your <code>.proto</code> files ready, it's time to generate the <code>.dart</code> files that will contain the classes that you will be able to use with Dart.</p> <p>To do so, the first thing you have to do is to have <code>protoc</code> installed on your machine, as well as the Dart plugin for Protobuf. If you don't have them installed, you can get them here:</p> <ul><li><a href="https://github.com/protocolbuffers/protobuf#protocol-compiler-installation" target="_blank" rel="noopener noreferrer">Protobuf compiler (<code>protoc</code>)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://pub.dev/packages/protoc_plugin" target="_blank" rel="noopener noreferrer">Dart <code>protoc</code> plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>Once you have them installed, you can now generate your Dart files running the following script:</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># Define variables</span>
<span class="token assign-left variable">OUT</span><span class="token operator">=</span>lib/proto
<span class="token assign-left variable">PROTO</span><span class="token operator">=</span>proto
<span class="token assign-left variable">THIRD_PARTY</span><span class="token operator">=</span>third_party

<span class="token comment"># Generate the third party Protobuf implementations</span>
<span class="token assign-left variable">PROTOC</span><span class="token operator">=</span><span class="token string">&quot;protoc --dart_out=grpc:<span class="token variable">$OUT</span> -I<span class="token variable">$THIRD_PARTY</span>/proto&quot;</span>
<span class="token assign-left variable">proto_dirs</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">find</span> <span class="token string">&quot;<span class="token variable">$THIRD_PARTY</span>/proto&quot;</span> -path -prune -o -name <span class="token string">'*.proto'</span> -print0 <span class="token operator">|</span> <span class="token function">xargs</span> -0 -n1 <span class="token function">dirname</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token operator">|</span> <span class="token function">uniq</span><span class="token variable">)</span></span>
<span class="token keyword">for</span> <span class="token for-or-select variable">dir</span> <span class="token keyword">in</span> <span class="token variable">$proto_dirs</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
  <span class="token variable">$PROTOC</span> -I<span class="token variable">$THIRD_PARTY</span>/proto <span class="token variable"><span class="token variable">$(</span><span class="token function">find</span> <span class="token string">&quot;<span class="token variable">${dir}</span>&quot;</span> -maxdepth <span class="token number">1</span> -name <span class="token string">'*.proto'</span><span class="token variable">)</span></span>
<span class="token keyword">done</span>

<span class="token comment"># Generate the Cosmos Protobuf implementation</span>
<span class="token assign-left variable">proto_dirs</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">find</span> <span class="token string">&quot;<span class="token variable">$PROTO</span>&quot;</span> -path -prune -o -name <span class="token string">'*.proto'</span> -print0 <span class="token operator">|</span> <span class="token function">xargs</span> -0 -n1 <span class="token function">dirname</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token operator">|</span> <span class="token function">uniq</span><span class="token variable">)</span></span>
<span class="token keyword">for</span> <span class="token for-or-select variable">dir</span> <span class="token keyword">in</span> <span class="token variable">$proto_dirs</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
  <span class="token variable">$PROTOC</span> -I<span class="token variable">$PROTO</span> <span class="token punctuation">\</span>
  --gocosmos_out<span class="token operator">=</span>plugins<span class="token operator">=</span>interfacetype+grpc,<span class="token punctuation">\</span>
Mgoogle/protobuf/any.proto<span class="token operator">=</span>github.com/cosmos/cosmos-sdk/codec/types:. <span class="token punctuation">\</span>
  <span class="token variable"><span class="token variable">$(</span><span class="token function">find</span> <span class="token string">&quot;<span class="token variable">${dir}</span>&quot;</span> -maxdepth <span class="token number">1</span> -name <span class="token string">'*.proto'</span><span class="token variable">)</span></span>
<span class="token keyword">done</span>

<span class="token comment"># Remove all .pbserver.dart files as they are unnecessary</span>
<span class="token function">find</span> <span class="token string">&quot;<span class="token variable">$OUT</span>&quot;</span> -name <span class="token string">&quot;*.pbserver.dart&quot;</span> -type f -delete
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>As you can see, this script uses three variables:</p> <ul><li><code>OUT</code>, which represents the folder inside which all the <code>.dart</code> files will be put once generated;</li> <li><code>PROTO</code>, which is the path to the <code>.proto</code> files that should be used to generate your custom types;</li> <li><code>THIRD_PARTY</code>, which is the folder inside which you have placed third parties' <code>.proto</code> files.</li></ul> <h2 id="build-errors"><a href="#build-errors" class="header-anchor">#</a> Build errors</h2> <p>It might happen that, after you have generated all your files, some errors pop up while building the project. The most commons are the ones like the following:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Error when reading 'lib/proto/google/protobuf/timestamp.pb.dart': No such file or directory
import '../../google/protobuf/timestamp.pb.dart' as $3;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Such errors appear if you did not include all the required <code>.proto</code> files inside the <code>third_party</code> folder. In the example above, we can see that it was not possible to build the project because the <code>../google/protobuf/timestamp.pb.dart</code> file does not exist.</p> <p>To solve this problem, the easiest way is to simply download the get <code>.proto</code> file and put into the appropriate folder. In this case, we should download the <code>timestamp.proto</code> file and put inside the <code>third_party/proto/google/protobuf</code> folder:</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">curl</span> https://raw.githubusercontent.com/protocolbuffers/protobuf/master/src/google/protobuf/timestamp.proto <span class="token operator">&gt;</span> third_party/proto/google/protobuf/timestamp.proto
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Once we have done so, we can simply re-run our generation script and make sure that everything builds properly.</p> <div class="custom-block tip"><p class="custom-block-title">Common missing files</p> <p>The most common missing files are the ones associated with two external dependencies that are highly used inside Cosmos: Protobuf and the Google APIs. If you are missing one or more files from either of those two projects, you can find all the files here:</p> <ul><li><a href="https://github.com/protocolbuffers/protobuf/tree/master/src/google/protobuf" target="_blank" rel="noopener noreferrer">Protobuf<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/googleapis/googleapis" target="_blank" rel="noopener noreferrer">Google APIs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/alan-sdk/alan.dart/edit/master/docs/custom-chains/overview.md" target="_blank" rel="noopener noreferrer">Edit this page on Github</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">7/25/2022, 9:25:38 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/alan.dart/modules/overview.html" class="prev">
        Supported Cosmos modules
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/alan.dart/assets/js/app.11920c19.js" defer></script><script src="/alan.dart/assets/js/2.d636a34c.js" defer></script><script src="/alan.dart/assets/js/8.bd141b9f.js" defer></script>
  </body>
</html>
